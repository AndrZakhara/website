/*!
 * website
 * Fiercely quick and opinionated front-ends
 * 
 * @author Andr Zakhar
 * @version 1.0.0
 * Copyright 2018. MIT licensed.
 */
/*!
 * website
 * Fiercely quick and opinionated front-ends
 * 
 * @author Andr Zakhar
 * @version 1.0.0
 * Copyright 2018. MIT licensed.
 */
let inputValue = '',
    selectedElement = '',
    // previous = false,
    // next = false,
    // parent = false,
    parentNode = '',
    // children = false,
    childrenNode = '';

function createAppStructure() {
  const inputSearch = createElement('input', { className: 'search-input', type: 'text', placeholder: 'Selector' });
  const btnSearch = createElement('input', { className: 'search-btn', type: 'button', value: 'search' });

  const btnPrev = createElement('input', { className: 'prev-btn', type: 'button', value: 'Prev' });
  const btnNext = createElement('input', { className: 'next-btn', type: 'button', value: 'Next' });
  const btnParent = createElement('input', { className: 'parent-btn', type: 'button', value: 'Parent' });
  const btnChildren = createElement('input', { className: 'children-btn', type: 'button', value: 'Children' });

  const textFieldWrapper = createElement('div', { className: 'text-field-wrapper' }, inputSearch, btnSearch);
  const btnWrapper = createElement('div', { className: 'btn-wrapper' }, btnPrev, btnNext, btnParent, btnChildren);

  const mainAppWrapper = createElement('div', { className: 'selector-search-app' }, textFieldWrapper, btnWrapper);

  btnSearch.disabled = true;
  btnPrev.disabled = true;
  btnNext.disabled = true;
  btnParent.disabled = true;
  btnChildren.disabled = true;

  btnSearch.addEventListener('click', handleSearch);
  inputSearch.addEventListener('input', handleInput);
  btnParent.addEventListener('click', handleParent);

  document.body.insertAdjacentElement('beforeend', mainAppWrapper);
}

const handleSearch = () => {
  inputValue = document.querySelector('.search-input').value;
  document.querySelector('.search-input').value = '';
  document.querySelector('.search-btn').disabled = true;
  addClass();
};

const handleInput = (e) => {
  (e.target.value === '')
    ? document.querySelector('.search-btn').disabled = true
    :document.querySelector('.search-btn').disabled = false
};

const handleParent = () => {
  selectedElement.classList.remove('selected-element-search');
  selectedElement = parentNode;
  selectedElement.classList.add('selected-element-search');
  findRelative(selectedElement);
};

const addClass = () => {
  console.log('add class');
  console.log(selectedElement);
  try {
    if(selectedElement === '') {
      const selected = document.querySelector(inputValue);

      if (selected !== undefined && selected !== null) {
        selectedElement = selected;
        selectedElement.classList.add('selected-element-search');
        findRelative(selectedElement);
      }
      // console.log(selectedElement);
    }
    else if(selectedElement !== null || selectedElement !== undefined) {
      selectedElement.classList.remove('selected-element-search');
      const selected = document.querySelector(inputValue);

      if (selected !== undefined && selected !== null) {
        selectedElement = selected;
        selectedElement.classList.add('selected-element-search');
        findRelative(selectedElement);
      }
    }
  } catch (err) {
    document.querySelector('.search-btn').disabled = true;
    document.querySelector('.prev-btn').disabled = true;
    document.querySelector('.next-btn').disabled = true;
    document.querySelector('.parent-btn').disabled = true;
    document.querySelector('.children-btn').disabled = true;
  }

  document.querySelector('.search-btn').disabled = true;
  scrollToElement('.selected-element-search');
};

// const removeClass = () => {
//   if(selectedElement !== null || selectedElement !== undefined) {
//     selectedElement.classList.remove('selected-element-search');
//   }
// };

function scrollToElement(theElement) {
  let selectedPosX = 0;
  let selectedPosY = 0;

  if (typeof theElement === "string") theElement = document.querySelector(theElement);

    while (theElement !== null) {
        selectedPosX += theElement.offsetLeft;
        selectedPosY += theElement.offsetTop;
        theElement = theElement.offsetParent;
    }

    selectedPosY = selectedPosY-20;
    window.scrollTo(selectedPosX, selectedPosY);
}

function appInit() {
  createAppStructure();
}

function findRelative(element) {
  const tagNameParent = element.parentNode.tagName;
  const child = element.children[0];
  // console.log(element.childNodes);
  console.log(`tag: ${tagNameParent}`);
  console.log(`tagChild: ${child}`);

  if(element.parentNode !== undefined
    && tagNameParent !== 'BODY'
    && tagNameParent !== 'HTML'
    && tagNameParent !== 'document'
    && tagNameParent !== undefined
    ) {
    console.log(element.parentNode);
    document.querySelector('.parent-btn').disabled = false;
    parentNode = element.parentNode;
  }
  else {
    document.querySelector('.parent-btn').disabled = true;
    parentNode = '';
  }

  if(child !== undefined) {
    document.querySelector('.children-btn').disabled = false;
    childrenNode = child.tagName;
  }
  else {
    document.querySelector('.children-btn').disabled = true;
    childrenNode = '';
  }
}

function createElement(tag, props, ...children) {
  const element = document.createElement(tag);

  Object.keys(props).forEach(key => (element[key] = props[key]));

  children.forEach(child => {

    if (typeof child === "string") {
      child = document.createTextNode(child);
    }

    element.appendChild(child);
  });

  return element;
}

document.addEventListener("DOMContentLoaded", appInit);

//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNjcmlwdHMuanMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7OztBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBIiwiZmlsZSI6InNjcmlwdHMubWluLmpzIiwic291cmNlc0NvbnRlbnQiOlsibGV0IGlucHV0VmFsdWUgPSAnJyxcclxuICAgIHNlbGVjdGVkRWxlbWVudCA9ICcnLFxyXG4gICAgLy8gcHJldmlvdXMgPSBmYWxzZSxcclxuICAgIC8vIG5leHQgPSBmYWxzZSxcclxuICAgIC8vIHBhcmVudCA9IGZhbHNlLFxyXG4gICAgcGFyZW50Tm9kZSA9ICcnLFxyXG4gICAgLy8gY2hpbGRyZW4gPSBmYWxzZSxcclxuICAgIGNoaWxkcmVuTm9kZSA9ICcnO1xyXG5cclxuZnVuY3Rpb24gY3JlYXRlQXBwU3RydWN0dXJlKCkge1xyXG4gIGNvbnN0IGlucHV0U2VhcmNoID0gY3JlYXRlRWxlbWVudCgnaW5wdXQnLCB7IGNsYXNzTmFtZTogJ3NlYXJjaC1pbnB1dCcsIHR5cGU6ICd0ZXh0JywgcGxhY2Vob2xkZXI6ICdTZWxlY3RvcicgfSk7XHJcbiAgY29uc3QgYnRuU2VhcmNoID0gY3JlYXRlRWxlbWVudCgnaW5wdXQnLCB7IGNsYXNzTmFtZTogJ3NlYXJjaC1idG4nLCB0eXBlOiAnYnV0dG9uJywgdmFsdWU6ICdzZWFyY2gnIH0pO1xyXG5cclxuICBjb25zdCBidG5QcmV2ID0gY3JlYXRlRWxlbWVudCgnaW5wdXQnLCB7IGNsYXNzTmFtZTogJ3ByZXYtYnRuJywgdHlwZTogJ2J1dHRvbicsIHZhbHVlOiAnUHJldicgfSk7XHJcbiAgY29uc3QgYnRuTmV4dCA9IGNyZWF0ZUVsZW1lbnQoJ2lucHV0JywgeyBjbGFzc05hbWU6ICduZXh0LWJ0bicsIHR5cGU6ICdidXR0b24nLCB2YWx1ZTogJ05leHQnIH0pO1xyXG4gIGNvbnN0IGJ0blBhcmVudCA9IGNyZWF0ZUVsZW1lbnQoJ2lucHV0JywgeyBjbGFzc05hbWU6ICdwYXJlbnQtYnRuJywgdHlwZTogJ2J1dHRvbicsIHZhbHVlOiAnUGFyZW50JyB9KTtcclxuICBjb25zdCBidG5DaGlsZHJlbiA9IGNyZWF0ZUVsZW1lbnQoJ2lucHV0JywgeyBjbGFzc05hbWU6ICdjaGlsZHJlbi1idG4nLCB0eXBlOiAnYnV0dG9uJywgdmFsdWU6ICdDaGlsZHJlbicgfSk7XHJcblxyXG4gIGNvbnN0IHRleHRGaWVsZFdyYXBwZXIgPSBjcmVhdGVFbGVtZW50KCdkaXYnLCB7IGNsYXNzTmFtZTogJ3RleHQtZmllbGQtd3JhcHBlcicgfSwgaW5wdXRTZWFyY2gsIGJ0blNlYXJjaCk7XHJcbiAgY29uc3QgYnRuV3JhcHBlciA9IGNyZWF0ZUVsZW1lbnQoJ2RpdicsIHsgY2xhc3NOYW1lOiAnYnRuLXdyYXBwZXInIH0sIGJ0blByZXYsIGJ0bk5leHQsIGJ0blBhcmVudCwgYnRuQ2hpbGRyZW4pO1xyXG5cclxuICBjb25zdCBtYWluQXBwV3JhcHBlciA9IGNyZWF0ZUVsZW1lbnQoJ2RpdicsIHsgY2xhc3NOYW1lOiAnc2VsZWN0b3Itc2VhcmNoLWFwcCcgfSwgdGV4dEZpZWxkV3JhcHBlciwgYnRuV3JhcHBlcik7XHJcblxyXG4gIGJ0blNlYXJjaC5kaXNhYmxlZCA9IHRydWU7XHJcbiAgYnRuUHJldi5kaXNhYmxlZCA9IHRydWU7XHJcbiAgYnRuTmV4dC5kaXNhYmxlZCA9IHRydWU7XHJcbiAgYnRuUGFyZW50LmRpc2FibGVkID0gdHJ1ZTtcclxuICBidG5DaGlsZHJlbi5kaXNhYmxlZCA9IHRydWU7XHJcblxyXG4gIGJ0blNlYXJjaC5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGhhbmRsZVNlYXJjaCk7XHJcbiAgaW5wdXRTZWFyY2guYWRkRXZlbnRMaXN0ZW5lcignaW5wdXQnLCBoYW5kbGVJbnB1dCk7XHJcbiAgYnRuUGFyZW50LmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgaGFuZGxlUGFyZW50KTtcclxuXHJcbiAgZG9jdW1lbnQuYm9keS5pbnNlcnRBZGphY2VudEVsZW1lbnQoJ2JlZm9yZWVuZCcsIG1haW5BcHBXcmFwcGVyKTtcclxufVxyXG5cclxuY29uc3QgaGFuZGxlU2VhcmNoID0gKCkgPT4ge1xyXG4gIGlucHV0VmFsdWUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuc2VhcmNoLWlucHV0JykudmFsdWU7XHJcbiAgZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnNlYXJjaC1pbnB1dCcpLnZhbHVlID0gJyc7XHJcbiAgZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnNlYXJjaC1idG4nKS5kaXNhYmxlZCA9IHRydWU7XHJcbiAgYWRkQ2xhc3MoKTtcclxufTtcclxuXHJcbmNvbnN0IGhhbmRsZUlucHV0ID0gKGUpID0+IHtcclxuICAoZS50YXJnZXQudmFsdWUgPT09ICcnKVxyXG4gICAgPyBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuc2VhcmNoLWJ0bicpLmRpc2FibGVkID0gdHJ1ZVxyXG4gICAgOmRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5zZWFyY2gtYnRuJykuZGlzYWJsZWQgPSBmYWxzZVxyXG59O1xyXG5cclxuY29uc3QgaGFuZGxlUGFyZW50ID0gKCkgPT4ge1xyXG4gIHNlbGVjdGVkRWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKCdzZWxlY3RlZC1lbGVtZW50LXNlYXJjaCcpO1xyXG4gIHNlbGVjdGVkRWxlbWVudCA9IHBhcmVudE5vZGU7XHJcbiAgc2VsZWN0ZWRFbGVtZW50LmNsYXNzTGlzdC5hZGQoJ3NlbGVjdGVkLWVsZW1lbnQtc2VhcmNoJyk7XHJcbiAgZmluZFJlbGF0aXZlKHNlbGVjdGVkRWxlbWVudCk7XHJcbn07XHJcblxyXG5jb25zdCBhZGRDbGFzcyA9ICgpID0+IHtcclxuICBjb25zb2xlLmxvZygnYWRkIGNsYXNzJyk7XHJcbiAgY29uc29sZS5sb2coc2VsZWN0ZWRFbGVtZW50KTtcclxuICB0cnkge1xyXG4gICAgaWYoc2VsZWN0ZWRFbGVtZW50ID09PSAnJykge1xyXG4gICAgICBjb25zdCBzZWxlY3RlZCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoaW5wdXRWYWx1ZSk7XHJcblxyXG4gICAgICBpZiAoc2VsZWN0ZWQgIT09IHVuZGVmaW5lZCAmJiBzZWxlY3RlZCAhPT0gbnVsbCkge1xyXG4gICAgICAgIHNlbGVjdGVkRWxlbWVudCA9IHNlbGVjdGVkO1xyXG4gICAgICAgIHNlbGVjdGVkRWxlbWVudC5jbGFzc0xpc3QuYWRkKCdzZWxlY3RlZC1lbGVtZW50LXNlYXJjaCcpO1xyXG4gICAgICAgIGZpbmRSZWxhdGl2ZShzZWxlY3RlZEVsZW1lbnQpO1xyXG4gICAgICB9XHJcbiAgICAgIC8vIGNvbnNvbGUubG9nKHNlbGVjdGVkRWxlbWVudCk7XHJcbiAgICB9XHJcbiAgICBlbHNlIGlmKHNlbGVjdGVkRWxlbWVudCAhPT0gbnVsbCB8fCBzZWxlY3RlZEVsZW1lbnQgIT09IHVuZGVmaW5lZCkge1xyXG4gICAgICBzZWxlY3RlZEVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZSgnc2VsZWN0ZWQtZWxlbWVudC1zZWFyY2gnKTtcclxuICAgICAgY29uc3Qgc2VsZWN0ZWQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGlucHV0VmFsdWUpO1xyXG5cclxuICAgICAgaWYgKHNlbGVjdGVkICE9PSB1bmRlZmluZWQgJiYgc2VsZWN0ZWQgIT09IG51bGwpIHtcclxuICAgICAgICBzZWxlY3RlZEVsZW1lbnQgPSBzZWxlY3RlZDtcclxuICAgICAgICBzZWxlY3RlZEVsZW1lbnQuY2xhc3NMaXN0LmFkZCgnc2VsZWN0ZWQtZWxlbWVudC1zZWFyY2gnKTtcclxuICAgICAgICBmaW5kUmVsYXRpdmUoc2VsZWN0ZWRFbGVtZW50KTtcclxuICAgICAgfVxyXG4gICAgfVxyXG4gIH0gY2F0Y2ggKGVycikge1xyXG4gICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnNlYXJjaC1idG4nKS5kaXNhYmxlZCA9IHRydWU7XHJcbiAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucHJldi1idG4nKS5kaXNhYmxlZCA9IHRydWU7XHJcbiAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcubmV4dC1idG4nKS5kaXNhYmxlZCA9IHRydWU7XHJcbiAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucGFyZW50LWJ0bicpLmRpc2FibGVkID0gdHJ1ZTtcclxuICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5jaGlsZHJlbi1idG4nKS5kaXNhYmxlZCA9IHRydWU7XHJcbiAgfVxyXG5cclxuICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuc2VhcmNoLWJ0bicpLmRpc2FibGVkID0gdHJ1ZTtcclxuICBzY3JvbGxUb0VsZW1lbnQoJy5zZWxlY3RlZC1lbGVtZW50LXNlYXJjaCcpO1xyXG59O1xyXG5cclxuLy8gY29uc3QgcmVtb3ZlQ2xhc3MgPSAoKSA9PiB7XHJcbi8vICAgaWYoc2VsZWN0ZWRFbGVtZW50ICE9PSBudWxsIHx8IHNlbGVjdGVkRWxlbWVudCAhPT0gdW5kZWZpbmVkKSB7XHJcbi8vICAgICBzZWxlY3RlZEVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZSgnc2VsZWN0ZWQtZWxlbWVudC1zZWFyY2gnKTtcclxuLy8gICB9XHJcbi8vIH07XHJcblxyXG5mdW5jdGlvbiBzY3JvbGxUb0VsZW1lbnQodGhlRWxlbWVudCkge1xyXG4gIGxldCBzZWxlY3RlZFBvc1ggPSAwO1xyXG4gIGxldCBzZWxlY3RlZFBvc1kgPSAwO1xyXG5cclxuICBpZiAodHlwZW9mIHRoZUVsZW1lbnQgPT09IFwic3RyaW5nXCIpIHRoZUVsZW1lbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKHRoZUVsZW1lbnQpO1xyXG5cclxuICAgIHdoaWxlICh0aGVFbGVtZW50ICE9PSBudWxsKSB7XHJcbiAgICAgICAgc2VsZWN0ZWRQb3NYICs9IHRoZUVsZW1lbnQub2Zmc2V0TGVmdDtcclxuICAgICAgICBzZWxlY3RlZFBvc1kgKz0gdGhlRWxlbWVudC5vZmZzZXRUb3A7XHJcbiAgICAgICAgdGhlRWxlbWVudCA9IHRoZUVsZW1lbnQub2Zmc2V0UGFyZW50O1xyXG4gICAgfVxyXG5cclxuICAgIHNlbGVjdGVkUG9zWSA9IHNlbGVjdGVkUG9zWS0yMDtcclxuICAgIHdpbmRvdy5zY3JvbGxUbyhzZWxlY3RlZFBvc1gsIHNlbGVjdGVkUG9zWSk7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGFwcEluaXQoKSB7XHJcbiAgY3JlYXRlQXBwU3RydWN0dXJlKCk7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGZpbmRSZWxhdGl2ZShlbGVtZW50KSB7XHJcbiAgY29uc3QgdGFnTmFtZVBhcmVudCA9IGVsZW1lbnQucGFyZW50Tm9kZS50YWdOYW1lO1xyXG4gIGNvbnN0IGNoaWxkID0gZWxlbWVudC5jaGlsZHJlblswXTtcclxuICAvLyBjb25zb2xlLmxvZyhlbGVtZW50LmNoaWxkTm9kZXMpO1xyXG4gIGNvbnNvbGUubG9nKGB0YWc6ICR7dGFnTmFtZVBhcmVudH1gKTtcclxuICBjb25zb2xlLmxvZyhgdGFnQ2hpbGQ6ICR7Y2hpbGR9YCk7XHJcblxyXG4gIGlmKGVsZW1lbnQucGFyZW50Tm9kZSAhPT0gdW5kZWZpbmVkXHJcbiAgICAmJiB0YWdOYW1lUGFyZW50ICE9PSAnQk9EWSdcclxuICAgICYmIHRhZ05hbWVQYXJlbnQgIT09ICdIVE1MJ1xyXG4gICAgJiYgdGFnTmFtZVBhcmVudCAhPT0gJ2RvY3VtZW50J1xyXG4gICAgJiYgdGFnTmFtZVBhcmVudCAhPT0gdW5kZWZpbmVkXHJcbiAgICApIHtcclxuICAgIGNvbnNvbGUubG9nKGVsZW1lbnQucGFyZW50Tm9kZSk7XHJcbiAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucGFyZW50LWJ0bicpLmRpc2FibGVkID0gZmFsc2U7XHJcbiAgICBwYXJlbnROb2RlID0gZWxlbWVudC5wYXJlbnROb2RlO1xyXG4gIH1cclxuICBlbHNlIHtcclxuICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5wYXJlbnQtYnRuJykuZGlzYWJsZWQgPSB0cnVlO1xyXG4gICAgcGFyZW50Tm9kZSA9ICcnO1xyXG4gIH1cclxuXHJcbiAgaWYoY2hpbGQgIT09IHVuZGVmaW5lZCkge1xyXG4gICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmNoaWxkcmVuLWJ0bicpLmRpc2FibGVkID0gZmFsc2U7XHJcbiAgICBjaGlsZHJlbk5vZGUgPSBjaGlsZC50YWdOYW1lO1xyXG4gIH1cclxuICBlbHNlIHtcclxuICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5jaGlsZHJlbi1idG4nKS5kaXNhYmxlZCA9IHRydWU7XHJcbiAgICBjaGlsZHJlbk5vZGUgPSAnJztcclxuICB9XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGNyZWF0ZUVsZW1lbnQodGFnLCBwcm9wcywgLi4uY2hpbGRyZW4pIHtcclxuICBjb25zdCBlbGVtZW50ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCh0YWcpO1xyXG5cclxuICBPYmplY3Qua2V5cyhwcm9wcykuZm9yRWFjaChrZXkgPT4gKGVsZW1lbnRba2V5XSA9IHByb3BzW2tleV0pKTtcclxuXHJcbiAgY2hpbGRyZW4uZm9yRWFjaChjaGlsZCA9PiB7XHJcblxyXG4gICAgaWYgKHR5cGVvZiBjaGlsZCA9PT0gXCJzdHJpbmdcIikge1xyXG4gICAgICBjaGlsZCA9IGRvY3VtZW50LmNyZWF0ZVRleHROb2RlKGNoaWxkKTtcclxuICAgIH1cclxuXHJcbiAgICBlbGVtZW50LmFwcGVuZENoaWxkKGNoaWxkKTtcclxuICB9KTtcclxuXHJcbiAgcmV0dXJuIGVsZW1lbnQ7XHJcbn1cclxuXHJcbmRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJET01Db250ZW50TG9hZGVkXCIsIGFwcEluaXQpO1xyXG4iXX0=
